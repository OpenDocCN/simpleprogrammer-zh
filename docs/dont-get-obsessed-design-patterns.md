# 不要沉迷于设计模式

> 原文：<https://simpleprogrammer.com/dont-get-obsessed-design-patterns/>

正确使用时，设计模式可以成为我们最好的盟友。

然而，当用在错误的地方，它们可能弊大于利。我们必须学会如何正确使用它们。

由于设计模式是对特定类型问题的预定义解决方案，经过时间的检验，并且为软件社区所知，所以一旦有机会，你可能会尝试应用它。

当你学习一项新技术时，尽快在野外尝试一下是有好处的。然而，对我来说，抱着“寻找最微小的机会将模式引入代码”的心态似乎是个坏主意。

我如何知道什么时候使用设计模式是最好的？正如我们将在下面看到的，评估代码不同部分发生变化的可能性，理解我们使用的模式的意图，对于做出适当的决定是至关重要的。

我通过考虑三件事得出了这个结论。让我们来看看它们。

## 如果你知道并应用面向对象的设计原则，设计模式就会自然而然地出现

![Design Pattern](img/80aad3529c55b04e11ee434817258f14.png)

我相信了解面向对象的设计原则和应用最佳实践，比如 T2 的坚实、T4 的亲亲和 YAGNI 的 T7，远比设计模式本身更重要。运用这些原则，**格局自然就出来了。** 

我们来看一个例子。假设我们正在开发一个显示乐谱的小程序。为了简单起见，让我们假设，现在，我们只画二分音符和四分音符。

在我们系统的不同类别中，我们有这样一个:

如你所见，这里有明显的重复。唯一的区别是应用于 *drawNoteHead* 方法的参数。

经过一番考虑后，您可能会得出结论，消除重复的一个好方法是执行以下操作:

1.  创建一个通用的 *drawNote* 方法，并从一个现有的函数中复制主体。
2.  将 *drawNoteHead* 方法的参数转换成一个新方法。然后，这个方法可以被子类覆盖，所以父类保存基本逻辑，子类保存差异。
3.  用适当子类的新的 *drawNote* 方法替换对 *drawHalfNote* 和 *drawQuarterNote* 的所有调用。

好吧，我们开始吧:

可能有其他的解决方案，但是我们得到了我们想要的:我们消除了代码的重复。

你猜怎么着？

你刚刚应用了模板模式。

就这样。想都没想。这就是面向对象设计原则的美妙之处。

你可能不知道世界上所有的设计模式，但是只要你知道好的面向对象设计原则，你就不必知道。

当然，如果你知道模板模式，你会马上看到它的到来。您会说“这是模板模式的完美场景”并应用它。这是应用模式的正确方式:当你清楚地看到它们是合适的，它们使你的生活变得更容易。

这就引出了我的第二点。

## 你可能根本不需要它

有时我们看着一段代码，我们对它的丑陋感到畏缩，我们立刻注意到一个模式可能会使它变得更好。

但是如果它有效并且你不需要改变它呢？

例如，让我们回到我们的乐谱显示应用程序，但场景略有不同。假设我们想为每种类型的谱号创建一个类。我们的应用程序将支持基于 3 个基本谱号的所有谱号:C、F 和 G 谱号。

我们的代码中有一个函数可以返回谱号的正确实例。看起来是这样的:

这是一些丑陋的代码。您可能有重构它的冲动，对吗？也许你正在考虑应用[工厂方法模式](http://www.joelrodriguezaleman.com/factory-method-pattern/)，是的，它会适合并且肯定会使代码更干净。

但是…如果我告诉你这段代码不会改变…永远不会？

我不是音乐家，所以我可能是错的，但对我来说，未来会发明新的音符似乎不现实。如果没有添加注释，那么就没有必要修改这个代码。不太可能，根本不值得去碰这个代码。

不管一段代码有多难看，如果它能工作并且你不需要改变它，重构代码(用设计模式或任何其他技术)有不必要的成本。

这就引出了我的第三点。

## 添加设计模式的成本

![Objected Oriented](img/38a93f258e4147c099c4feb672e070f8.png)

有许多不同的设计模式，但大多数都有一些共同点:当你应用它们时，你需要安排一些结构。换句话说，您需要向代码中添加类和/或接口。

在第一个例子中，这个结构由两个子类扩展的抽象类组成。此外，为了让旧代码使用这些新类，您还需要进行一些与设计模式本身没有直接关系的更新。

这个故事的寓意是:如果你正在考虑应用一个设计模式，考虑这样做的成本和潜在的好处。仅仅为了做而做将会使你的代码比它需要的更复杂。

## 我如何知道什么时候使用设计模式是最好的？

这是一个百万美元的问题。这取决于两件事:一段代码在未来有多大可能发生变化，以及模式的意图。

### 代码不同部分发生变化的可能性

我们在这篇文章中看到的例子展示了为了决定是否包含设计模式而考虑变更的重要性。

在第一个例子中，包含一个模式是绝对必要的。毕竟，我们不会满足于只有二分音符和四分音符的乐谱，不是吗？因为添加更多类型的笔记会使重复问题变得更糟，所以需要一种模式来避免这种情况。

在第二个例子中，情况正好相反。因为我们可以有把握地假设不会添加谱号或音符，所以这段代码不需要修改，因此也不需要包含模式。

### 模式的意图

仅仅知道一个模式是如何实现的是不够的；我们还需要知道模式存在背后的原因。

换句话说:我们需要知道模式是用来做什么的。

我们需要完全理解它所解决的问题。如果我们知道这一点，我们就更容易知道应用模式的适当时间。

在做这些决定时，我想到了两本书:

*   [Head First Design Patterns](http://www.amazon.com/exec/obidos/ASIN/0596007124/makithecompsi-20) :如果你以前从未听说过设计模式，或者你刚刚开始，这本书是必须的。它以一种非常友好和简单的方式解释了最常用的设计模式。
*   设计模式:可重用的面向对象软件的元素:这是一部经典著作，也是必读之作。它是作为最常见的设计模式的目录编写的，这些模式被组织成三个主要类别:创建性的、结构性的和行为性的。

不幸的是，我们还必须面对另一个问题:在野外识别和应用模式。

当您从头开始编写新代码时，很容易在编写过程中发现对模式的需求。然而，获取旧代码并使其使用设计模式更具挑战性。

在接触代码之前，您需要确保完全理解代码的作用。弄清楚这一点可能是最容易的，也可能是最痛苦的经历，这取决于代码有多复杂。

幸运的是，有另一本书可以帮助解决这个问题:[重构模式](http://www.amazon.com/exec/obidos/ASIN/0321213351/makithecompsi-20)。这本书告诉你如何实际利用现有的代码，并将设计模式集成到其中。

这些书，以及其他许多书，都是约翰的编程书籍终极清单中的特色，我强烈推荐。

## 结论

![Conclusion](img/d11f6e6ba4d81e59ccd866a1554e508a.png)

设计模式不是编程的圣杯。其实我觉得这样的事情是不存在的。

它们只是一种机制，当正确应用时，可以使我们的代码更干净、更容易理解和维护。

那么，你认为什么时候使用设计模式合适，什么时候不合适呢？请在下面的评论中告诉我们。

*一定要看看我们简单的程序员课程——[如何把自己推销成一名软件开发人员](https://simpleprogrammer.com/store/products/how-to-market-yourself/)来获取职业发展的技巧和诀窍。*