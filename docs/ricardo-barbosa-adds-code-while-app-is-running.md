# 里卡多·巴博萨在应用程序运行时添加代码

> 原文：<https://simpleprogrammer.com/ricardo-barbosa-adds-code-while-app-is-running/>

里卡多·巴博萨认为他不是“真正的”企业家，只是因为他白天为一家电信公司工作。然而，他称自己本质上是一名企业家，为其他开发者快速完成工作创造产品和系统。他一直是。NET 空间和微软技术已经很长时间了。

不久前，我遇到了里卡多，当时他就他的一个想法联系了我——这个想法可能是最终被称为 CodeCop 的前身。当我看到他在做什么的时候，我不得不放下一切。我收到很多看东西的请求，但想法是不同的，我必须检查一下。

Ricardo 将 CodeCop 描述为“把弗兰肯斯坦和一只鸡混合在一起”，它会让你做方法拦截。NET 使用 JSON。请查看里卡多·巴博萨、的 **[视频采访，并阅读他在此分享的 Q &。](https://youtu.be/tcNUkHuPHYw)**

![](img/f50c991ecf55ea3c8668563625757f67.png)

Ricardo Barbosa 是 Truphone 的网络软件工程师。他是 CodeCop 的创造者。

## 什么是 CodeCop？我为什么要在乎？

CodeCop 是一个用于. NET 的实时方法拦截库。它允许你在应用程序运行的同时添加或替换来自任何程序集的任何方法中的代码。它对于很多情况都非常有用，包括测试场景、模仿、样板代码缩减、代码隔离(横切关注点)、AOP(面向方面编程)等等。

## 和同类产品有什么区别？

首先，它可以实时工作，这意味着您可以不断地更改或添加行为，而无需重新编译和重新部署。第二，它基于 JSON API(尽管也有一个流畅的 API ),这使得它不会“代码膨胀”。第三，它是市场上第一个真正不引人注目的拦截库，因为你只需要在你的应用程序中调用一个引导程序就可以了。

## 从高层次的角度来看，如何用 JSON 在方法上放置拦截器呢？

好吧，CodeCop 在应用程序启动时只需一行代码就能自动启动。在启动过程中，它会寻找一个名为 copconfig.json 的 JSON 文件，该文件包含您希望它拦截的所有类型和方法，以及每个方法或全局的拦截器的位置和操作方式。

## 哪些方法和程序集可以被截获？我能截取控制台吗？用 WriteLine 方法吗？

开箱即用，所有非 NGEN 编译的程序集。NET 4.0 及更高版本，以及几乎任何方法。对于像 BCL where 控制台这样的 NGEN 程序集。WriteLine 驻留，所有要做的就是通过配置强制 JIT 编译，它也会被拦截。

## 什么？它在引擎盖下使用网络拦截技术吗？为什么是那个而不是其他的？

它使用 jit 挂钩的“古老艺术”。我选择它是因为我用了一年半的时间尝试了很多东西。从摆弄指针，或者摆弄框架已经给你的东西，到动态编译，这种技术被证明是最有效的。当你开始在静态编译语言中使用截取时，你实际上进入了反自然的空间，所以你真的需要一种技术来让你完全控制 CLR 将要执行什么。

## 安全吗？有人能用它黑我的应用吗？

有人曾经说过，安全是一台被水泥包裹的机器，埋在 10 英尺深的地方，但我仍然怀疑它是否安全。安全是你想要的。如果你的服务器以任何方式受到损害，CodeCop 和任何其他应用程序都不会安全。但是，是的，我们考虑过使它安全，所以我们强制每个应用程序进行引导调用，显示明确的拦截意图。没有它，没有人可以指向 CodeCop 在您的应用程序。

## CodeCop 有三种产品类型:免费版、开发者版和旗舰版。他们有什么区别？

基本上区别在于您可以拦截的方法数量:免费的 25 个，开发人员的 150 个，终极版的无限个。免费版没有支持，终极版有我们称之为高级(高优先级)的支持。

## 局限性？

如果您没有禁用通过配置加载 NGEN 映像和编译为低于 4.0 的. NET 版本的程序集，则为 NGEN 程序集。目前也不支持 RyuJIT，但像 NGEN 一样，你可以通过配置禁用它。

## 未来版本、新功能等的计划。？

尽管 API 已经成熟，但仍有许多东西需要在代码和语义上进行调整。发布一个巨大的现成的拦截器集，集成众所周知的库，用于日志记录、错误处理等。我们已经在 nuget 和我们网站的社区部分提供了一些。

我们也在准备网上培训课程，视频，尽可能的展示。

## 有哪些给开发者看的书推荐？

对我来说，推荐一本约翰写的书似乎有点俗气，但我还是会这样做，因为这是我读的最后一本书，我完全爱上了它。软技能:软件开发人员的生活手册，作者 John Sonmez 。因为我有这种创业精神，那里写的每一件事在我听来都像音乐。这里有很多建议和忠告，不仅是职业方面的，也是我们所有人的结构化业务。对于像我这样想成为企业家的人来说，这是不可或缺的。

当然，我不能让这个时刻过去，而不参考所有的极客书籍，为我提供了一些关于。所以我推荐这个疯狂的“怪物”Jeffrey Richter 的 c#CLR。另一个我喜欢的是穆罕默德·拉赫曼解构的 [C#的](http://www.amazon.com/exec/obidos/ASIN/B011DB0Q58/makithecompsi-20)。[亲。Sasha Goldshtein 的 NET Performance book](http://www.amazon.com/exec/obidos/ASIN/1430244585/makithecompsi-20) 也有一些很好的章节，真正阐明了类型内部机制。美好的事物必不可少。NET，第 1 卷-公共语言运行时，作者是另外两位“巨人”，Don Box 和 Chris Sells，最后但并非最不重要的是阐明 IL 汇编的是[专家。Serge Lidin 的 NET 2.0 IL 汇编程序](http://www.amazon.com/exec/obidos/ASIN/1590596463/makithecompsi-20)一书。

此外，马克·鲁西诺维奇的所有 [Windows Internals](http://www.amazon.com/exec/obidos/ASIN/0735648735/makithecompsi-20) 书籍对于任何想了解你的应用程序所立足的操作系统的人来说都是必不可少的。