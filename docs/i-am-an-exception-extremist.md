# 我是一个例外的极端分子

> 原文：<https://simpleprogrammer.com/i-am-an-exception-extremist/>

今天进行了一次代码审查，我意识到我是一个例外的极端主义者，一个例外的偏执狂。

我不喜欢例外。我宁愿吐出来也不愿抛出一个异常。

我有一个规则，如果你能察觉到这种情况，这不是一个例外，这个规则没有例外。(好吧，有一个例外[我之前在博客中提到过，但是它让代码更加简洁。)](https://simpleprogrammer.com/2010/06/25/dont-chain-failure-states-in-returns/)

## 为什么我不喜欢例外

大多数时候，当你的代码在生产中运行时，你会发现一个 API 抛出了一个。

当然，我也讨厌在 Java 中被迫使用检查异常来处理异常。

我非常不喜欢异常的一点是，它们破坏了代码流。异常本质上是 goto 语句。你不可能总是确切地知道代码流将会流向哪里。

我也真的不喜欢当我处理一个异常时，我必须在 try catch 块上声明我的变量，这样我就可以在块之后使用它。我明白我为什么这么做，但我就是不喜欢。这让我很生气，因为现在我不得不尝试将这个变量初始化为有意义的默认值。

异常还会导致糟糕的代码，比如:

我不认为我需要解释以上代码。



![eatedit](img/d49a7b95413bab63513aa6594feec4d8.png "eatedit")



异常也会发出错误警报。我是说真的，我传递给你一个带美元符号的字符串有什么大不了的吗？如果我给你一个“$3.00”并让你把它解析成一个我想要的整数 3，你难道想不出来吗？饶了我吧。当我看到例外的时候，我会想，“一些非常糟糕的事情发生了，可能会导致整个宇宙毁灭。”我不认为“也许我把美元符号忘在我的绳子上了。”

我不喜欢例外的首要原因是:“我的收件箱里都是例外。”我工作的每个地方都一样。通过电子邮件发送未捕获的异常。显然抛出异常并不是很好。是的，我知道系统抛出了空指针异常，你对此无能为力。(除了可能，嗯，我们忽略对空对象的方法调用……)

## 改做什么？

嗯，在挥舞例外旗帜之前，我们可以设置几道防线:

1.  看看你能不能用这些数据做些聪明的事情。例如，如果您正在编写将字符串解析为数字的代码，可以忽略非数字字符吗？有时候答案是否定的，但是很多时候你可以找到一种方法来利用你所拥有的。如果你能找到一种不抛出异常的方法，那就去做吧。
2.  如果你返回一些数据，返回一些默认值或空值。([虽然不空。这并不总是有意义的，但是这比抛出一个异常要好。](http://elegantcode.com/2010/05/01/say-no-to-null/)
3.  先给呼叫者一个检查成功的方法。从您的方法返回结果代码可能是不好的。但是，如果让我先调用一些东西来验证我的输入，至少我可以在那里处理问题。中的 tryParse 方法。NET 框架。它们让您检查某些内容是否可以解析，而不是在不能解析时抛出异常。
4.  如果异常不是源自您的代码，那么首先尝试在您的代码中处理它。有没有一种方法可以处理这个异常，而不是仅仅重新抛出或者包装它？
5.  如果您没有公开外部 API，请尝试使用某种错误集合，或者可以在您的类上检查的错误属性，以指示发生了故障。

## 如果你必须这么做，(有时你必须这么做)

*   不要再次抛出系统异常。该异常应该与您的抽象级别相匹配。包装异常(保持调用堆栈完整),然后抛出。
*   不要抛出五千万种不同的异常。没有人喜欢抓住你所有的例外。您可以在异常中包含详细信息，以说明具体发生了什么错误。

我的一个同事说得很有道理。他说那要看你的视角了。你可能不得不认为你是使用你的 API 的人。

最明显的做法是什么？您希望调用无声地失败还是抛出异常？

从代码用户的角度来看，这是值得考虑的。

公平地说，在这个问题上，我仍然犹豫不决。我真的不喜欢异常，但我也不喜欢在 API 中调用一个方法，然后调用另一个方法来检查错误条件。我当然不喜欢从方法返回的错误代码或布尔值来表示成功或失败。

你怎么想呢?