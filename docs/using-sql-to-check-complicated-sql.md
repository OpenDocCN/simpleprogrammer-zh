# 使用 SQL 检查复杂的

> 原文:[https://simple programmer . com/using-SQL-to-check-complicated-SQL/](https://simpleprogrammer.com/using-sql-to-check-complicated-sql/)

### 复杂的查询

我经常发现自己不得不编写相当复杂的 SQL 查询来获得符合特定标准的数据列表。复杂 SQL 查询的一个问题是很难知道结果是否正确，尤其是当查询涉及多表连接和子选择时。通常，复杂 SQL 查询中某个部分的小错误可能会被忽略，因为它不会极大地改变结果的数量。

不幸的是，有时无法通过简单的查询来获得特定的结果。通常，为创建查询而应用于数据的大量信息需要在数据库中直接指定的关系中找不到的外部知识。在这种情况下，验证查询结果的可靠技术非常重要。

### **SQL 检查 SQL**

我已经开始使用从两个不同方向处理查询的技术来检查我的结果。这个想法是，如果你能想到不止一种方法来获得你正在寻找的同一组数据，并且每种方法都返回相同的组或结果，那么数据正确的可能性就会大大增加。

《阿波罗 13 号》中有一个场景[汤姆·汉克斯](http://www.amazon.com/gp/search/?ie=UTF8&bbn=2625373011&camp=1789&creative=390957&field-lbr_actors_browse-bin=Tom%20Hanks&linkCode=ur2&qid=1375197353&rh=n%3A2625373011&tag=makithecompsi-20&x=-744&y=-197)手动计算了一些轨道，休斯顿的三个人都检查了他的数学以确保它是正确的。当他们都得出相同的答案时，每个人都可以非常肯定计算是正确的。



![](img/32a5fc630f64e60c44ccd63201f927d4.png "Apollo13MissionControl1")



这就是 SQL 检查 SQL 背后的思想。如果您可以编写第二个查询来获得相同的数据，但是从不同的角度来看，这个查询很有可能是正确的。最好的方法是让另一个人编写第二个查询，而不知道您是如何完成第一个查询的。

### 实际例子

听起来不错，但是我如何实际使用它呢？假设您有一个数据库，其中存储了求职申请和申请人的简历。假设您想要创建上周所有申请人的列表。

我们可以从两个角度来处理这个问题。

*   得到所有申请日期在上周的人的名单。
*   获取所有创建过简历的人的名单。

我们必须使用一些外部信息。我们必须知道，在我们的特定项目中，每个求职者只能提交一份简历，而且他们必须提交一份。然后我们知道，我们应该看到在这段时间内申请工作和创建简历的人的相同列表。

当然，这是一个非常简单的例子，在给定所有条件的情况下，很容易确定这两个查询中的任何一个，而无需同时运行两个查询。问题是，当您有一个大得多的要交互的表集，并且表和数据之间的关系不稳定时。

### 提示和技巧

一旦创建了两个查询来获得相同的结果数据集，如何轻松地检查它们是否包含相同的数据？最简单的方法是在 SQL 中做一个区别。根据您使用的 SQL 的风格，语法略有不同。您可以查找适合您的 SQL 风格的集合操作。差异是联合的对立面。差异允许您查看哪些记录存在于第一个查询中，而不是第二个查询中。我喜欢先对第一个查询使用 difference，再对第二个查询使用 difference，这样我就可以看到两个查询中有哪些记录，而另一个查询中没有。我发现的任何记录，我都会仔细检查，找出为什么它们在一个记录中，而不在另一个记录中。每次这样做时，我都会修改错误的查询，直到所有结果完全匹配。

这两种查询的平衡有助于突出从问题的任何一个角度看都可能忽略的问题。在平衡两个查询以获得完全相同的结果后，结果很有可能是正确的。当然，与“即兴发挥”相比，你的查询正确的机会增加了